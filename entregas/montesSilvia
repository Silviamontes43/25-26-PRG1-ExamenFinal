import java.util.Scanner;

public class SimuladorCajero {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);

        static final double SALDO_INICIAL = 1000.0;
        static final double COMISION = 1.0;
        static final double LIMITE_DIARIO = 600.0;
        static final int HIST_MAX = 10

        static double saldo = SALDO_INICIAL;
        static double totalRetirado = 0;
        static double totalDepositado = 0;
        static double comisiones = 0;
        static double retiradoHoy = 0;
        static int operaciones = 0;



        
      static String[] histTipo = new String[HIST_MAX];
      static double[] histMonto = new double[HIST_MAX];
      static int histIndex = 0;
      static int histCount = 0;

 
        
        int opcion;

        System.out.println("Cajero Automático - Banco Nacional");
        System.out.println("Saldo inicial: " + SALDO_INICIAL + " euros");

        do {
            mostrarMenu();
            opcion = leerEntero(sc);

            switch (opcion) {
                case 1 -> consultarSaldo();
                case 2 -> retirar(sc);
                case 3 -> depositar(sc);
                case 4 -> verEstadisticas();
                case 6 -> verHistorial();
                case 7 -> borrarHistorial();
                case 0 -> avanzarDia();
                case 5 -> System.out.println("Gracias por usar el cajero. ¡Hasta pronto!");
                default -> System.out.println("Opción no válida.");
            }
        } while (opcion != 5);

        sc.close();
    }
        
    
        
        static void mostrarMenu() {
        System.out.println("""
                
                [1] Consultar saldo
                [2] Retirar dinero (comisión: 1 euro)
                [3] Depositar dinero
                [4] Ver estadísticas
                [5] Salir
                [6] Ver últimos movimientos
                [7] Borrar historial
                [0] Avanzar al siguiente día
                Seleccione opción:
                """);
    }

    static void consultarSaldo() {
        System.out.println("Saldo actual: " + saldo + " euros");
    }

    static void retirar() {
        System.out.print("Cantidad a retirar: ");
        double c = leerDouble(sc);

        if (c <= 0) {
            System.out.println("Cantidad inválida.");
            return;
        }

        if (retiradoHoy + c > LIMITE_DIARIO) {
            System.out.println("Límite diario excedido.");
            return;
        }


        if (retiradoHoy + c > LIMITE_DIARIO) {
            System.out.println("Límite diario excedido.");
            return;
        }

        if (saldo < c + COMISION) {
            System.out.println("Saldo insuficiente.");
            return;
        }

        saldo -= (c + COMISION);
        totalRetirado += c;
        comisiones += COMISION;
        retiradoHoy += c;
        operaciones++;

        guardarHistorial("Retiro", c);
        System.out.println("Retiro exitoso. Nuevo saldo: " + saldo);
    }


    static void depositar() {
        System.out.print("Cantidad a depositar: ");
        double c = leerDouble(sc);

        if (c <= 0) {
            System.out.println("Cantidad inválida.");
            return;
        }

        saldo += c;
        totalDepositado += c;
        operaciones++;

        guardarHistorial("Depósito", c);
        System.out.println("Depósito exitoso. Nuevo saldo: " + saldo);
    }


    static void verEstadisticas() {
        System.out.println("\nEstadísticas:");
        System.out.println("Operaciones: " + operaciones);
        System.out.println("Total retirado: " + totalRetirado);
        System.out.println("Total depositado: " + totalDepositado);
        System.out.println("Comisiones: " + comisiones);

        double saldoEsperado = SALDO_INICIAL + totalDepositado - totalRetirado - comisiones;
        System.out.println("Estado de cuenta: " +
                (saldo == saldoEsperado ? "CORRECTO" : "INCONSISTENTE"));
    }

    static void verHistorial() {
        if (histCount == 0) {
            System.out.println("No hay movimientos.");
            return;
        }

        System.out.println("\nÚltimos movimientos:");
        for (int i = 0; i < histCount; i++) {
            int idx = (histIndex - histCount + i + HIST_MAX) % HIST_MAX;
            System.out.println((i + 1) + ". " + histTipo[idx] + ": " + histMonto[idx] + " euros");
        }
    }

    static void borrarHistorial() {
        histCount = 0;
        System.out.println("Historial borrado.");
    }

    static void avanzarDia() {
        retiradoHoy = 0;
        System.out.println("Nuevo día iniciado. Límite reiniciado.");
    }

    static void guardarHistorial(String tipo, double monto) {
        histTipo[histIndex] = tipo;
        histMonto[histIndex] = monto;
        histIndex = (histIndex + 1) % HIST_MAX;
        if (histCount < HIST_MAX) histCount++;
    }

    static int leerEntero(Scanner sc) {
        while (!sc.hasNextInt()) {
            sc.next();
            System.out.print("Ingrese un número válido: ");
        }
        return sc.nextInt();
    }

    static double leerDouble(Scanner sc) {
        while (!sc.hasNextDouble()) {
            sc.next();
            System.out.print("Ingrese un número válido: ");
        }
         sc.close();
    }
}























          
      